<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>clinicaltrials.gov to RIS</title>
<meta name="Generator" content="VSCode" />
<meta name="Author" content="William Witteman" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<link rel="stylesheet" href="https://pyscript.net/releases/2023.11.2/core.css" />
<script type="module" src="https://pyscript.net/releases/2023.11.2/core.js">
</script>

</head>
<body>
    <input type="file" id="csv" name="csv" accept="text/csv, text/tsv, text/txt" />

    <div id="print_output"></div>
    <br />
    <p>File Content:</p>
    <div style="border:2px inset #AAA;cursor:text;height:50%;overflow:auto;width:80%; resize:both">
      <div id="content">
      </div>
    </div>

    <py-script output="print_output">
import asyncio
import csv
import datetime
from js import document, FileReader
from pyodide.ffi import create_proxy

async def process_file(event):
	fileList = event.target.files.to_py()
	for f in fileList:
		data = await f.text()
		document.getElementById("content").innerHTML = data
 
def main():
	# Create a Python proxy for the callback function
	# process_file() is your function to process events from FileReader
	file_event = create_proxy(process_file)
 
	# Set the listener to the callback
	e = document.getElementById("csv")
	e.addEventListener("change", file_event, False)
 
main()
</py-script>

</body>
</html>